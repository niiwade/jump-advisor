"use strict";(()=>{var e={};e.id=276,e.ids=[276],e.modules={1708:e=>{e.exports=require("node:process")},3295:e=>{e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},4573:e=>{e.exports=require("node:buffer")},10846:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11723:e=>{e.exports=require("querystring")},12412:e=>{e.exports=require("assert")},16141:e=>{e.exports=require("node:zlib")},19771:e=>{e.exports=require("process")},21820:e=>{e.exports=require("os")},24815:(e,r,t)=>{t.r(r),t.d(r,{patchFetch:()=>g,routeModule:()=>h,serverHooks:()=>q,workAsyncStorage:()=>x,workUnitAsyncStorage:()=>m});var s={};t.r(s),t.d(s,{POST:()=>d});var o=t(96559),a=t(48088),i=t(37719),n=t(32190),u=t(35426),p=t(70809),c=t(70132),l=t(94112);async function d(e){try{let r=await (0,u.getServerSession)(p.N);if(!r||!r.user)return n.NextResponse.json({error:"Authentication required"},{status:401});let{messages:t,userId:s}=await e.json();if(s&&s!==r.user.id)return n.NextResponse.json({error:"User ID mismatch"},{status:403});let o=t.filter(e=>"user"===e.role).pop();if(!o)return n.NextResponse.json({error:"No user message found"},{status:400});await c.z.chatMessage.create({data:{userId:r.user.id,role:"user",content:o.content}});let a=await (0,l.E)(r.user.id,o.content,t);return await c.z.chatMessage.create({data:{userId:r.user.id,role:"assistant",content:a}}),n.NextResponse.json({role:"assistant",content:a})}catch(e){return console.error("Error in chat API:",e),n.NextResponse.json({error:"Failed to process your request"},{status:500})}}let h=new o.AppRouteRouteModule({definition:{kind:a.RouteKind.APP_ROUTE,page:"/api/chat/route",pathname:"/api/chat",filename:"route",bundlePath:"app/api/chat/route"},resolvedPagePath:"C:\\Users\\Joseph\\Documents\\Jump\\jump-advisor\\src\\app\\api\\chat\\route.ts",nextConfigOutput:"",userland:s}),{workAsyncStorage:x,workUnitAsyncStorage:m,serverHooks:q}=h;function g(){return(0,i.patchFetch)({workAsyncStorage:x,workUnitAsyncStorage:m})}},27910:e=>{e.exports=require("stream")},28354:e=>{e.exports=require("util")},29021:e=>{e.exports=require("fs")},29294:e=>{e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{e.exports=require("path")},34631:e=>{e.exports=require("tls")},37067:e=>{e.exports=require("node:http")},37830:e=>{e.exports=require("node:stream/web")},44708:e=>{e.exports=require("node:https")},44870:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},55511:e=>{e.exports=require("crypto")},55591:e=>{e.exports=require("https")},57075:e=>{e.exports=require("node:stream")},57975:e=>{e.exports=require("node:util")},63033:e=>{e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},70809:(e,r,t)=>{t.d(r,{N:()=>n});var s=t(16467),o=t(70132),a=t(36344);function i(e){let r=process.env[e];if(!r)throw Error(`Missing required env var: ${e}`);return r}console.log("NEXTAUTH_URL:",process.env.NEXTAUTH_URL),console.log("GOOGLE_CLIENT_ID:",process.env.GOOGLE_CLIENT_ID?"[Set]":"[Not Set]"),console.log("GOOGLE_CLIENT_SECRET:",process.env.GOOGLE_CLIENT_SECRET?"[Set]":"[Not Set]");let n={adapter:(0,s.y)(o.z),providers:[(0,a.A)({clientId:i("GOOGLE_CLIENT_ID"),clientSecret:i("GOOGLE_CLIENT_SECRET"),allowDangerousEmailAccountLinking:!0,authorization:{params:{scope:"openid email profile https://www.googleapis.com/auth/gmail.readonly https://www.googleapis.com/auth/calendar.readonly",prompt:"consent",access_type:"offline"}}}),function(e){return{id:"hubspot",name:"HubSpot",type:"oauth",allowDangerousEmailAccountLinking:!0,authorization:{url:"https://app.hubspot.com/oauth/authorize",params:{client_id:e.clientId,scope:"crm.schemas.contacts.read oauth",redirect_uri:e.callbackUrl}},token:{url:"https://api.hubapi.com/oauth/v1/token",async request({params:r,provider:t}){let s=await fetch(t.token?.url,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({grant_type:"authorization_code",client_id:e.clientId,client_secret:e.clientSecret,redirect_uri:e.callbackUrl,code:r.code})});return{tokens:await s.json()}}},userinfo:{url:"https://api.hubapi.com/oauth/v1/access-tokens/",async request({tokens:e}){return(await fetch(`${this.url}/${e.access_token}`,{headers:{Authorization:`Bearer ${e.access_token}`}})).json()}},profile(e){if(console.log("HubSpot profile data:",JSON.stringify(e,null,2)),!e.email)throw Error("HubSpot profile is missing email field");return{id:e.user_id||e.id||"hubspot-user",email:e.email,name:e.name||`${e.firstName||""} ${e.lastName||""}`.trim()||e.email.split("@")[0],image:null}}}}({clientId:i("HUBSPOT_CLIENT_ID"),clientSecret:i("HUBSPOT_CLIENT_SECRET"),callbackUrl:process.env.NEXTAUTH_URL?`${process.env.NEXTAUTH_URL}/api/auth/callback/hubspot`:"http://localhost:3000/api/auth/callback/hubspot"})],callbacks:{session:async({session:e,token:r})=>(e.user&&r.sub&&(e.user.id=r.sub),e),signIn:async({account:e})=>(e&&"google"===e.provider&&e.refresh_token_expires_in&&delete e.refresh_token_expires_in,!0),redirect:async({url:e,baseUrl:r})=>e.startsWith(r)?e.includes("callbackUrl")?e:`${r}/dashboard`:e.startsWith("/")?`${r}/dashboard`:r},pages:{signIn:"/login",error:"/login"},session:{strategy:"jwt"}}},73024:e=>{e.exports=require("node:fs")},73136:e=>{e.exports=require("node:url")},73496:e=>{e.exports=require("http2")},73566:e=>{e.exports=require("worker_threads")},74075:e=>{e.exports=require("zlib")},76760:e=>{e.exports=require("node:path")},77030:e=>{e.exports=require("node:net")},79428:e=>{e.exports=require("buffer")},79551:e=>{e.exports=require("url")},79646:e=>{e.exports=require("child_process")},81630:e=>{e.exports=require("http")},83997:e=>{e.exports=require("tty")},91645:e=>{e.exports=require("net")},94735:e=>{e.exports=require("events")},96330:e=>{e.exports=require("@prisma/client")}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[243,580,973,582,957,112],()=>t(24815));module.exports=s})();